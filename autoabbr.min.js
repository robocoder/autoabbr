!function(d){"use strict";var n,u,r,a,i,c,e,o,f,l;l={defTag:"abbr",attrKey:"data-definition",attrDef:"title",addClass:"definition",includeWord:"true",onComplete:null},d.fn.autoabbr=function(t){var e=this;d.extend(l,t),n={},l.words&&(n=l.words),l.src?d.get(l.src,function(t){d.extend(n,t),r(e)},"json"):r(e)},r=function(t){e(),i(t),"function"==typeof l.onComplete&&l.onComplete.call(t)},e=function(){var t={};for(var e in n)n.hasOwnProperty(e)&&o(e,t,0);c=t},o=function(t,e,r){var n=e[t[r]]||{};t[r+1]?o(t,n,r+1):n.word=!0,e[t[r]]=n},i=function(t){var e,r,n,o;for(e=0,r=(n=t.children()).length;e<r;e++)i(d(n[e]));for(e=0,r=(o=t.contents()).length;e<r;e++)3===o[e].nodeType&&a(o[e])},a=function(t){var e,r,n,o=[],d=t.nodeValue,a=c,i="",l={},s="";for(e=0,r=d.length;e<r;e++)n=d[e].toLowerCase(),a.hasOwnProperty(n)?(i+=n,(a=a[n]).word&&(l={i:e+1,word:i,key:s||i})):n.match(/^\W$/)?(a.word?o.push({i:e,word:i,key:s||i}):l.word&&o.push(l),i=s="",l={},a=c):a.hasOwnProperty("*")?(a={"*":!0,word:!0},s||(s=i+"*"),i+=n):a={};a.word?o.push({i:e,word:i,key:s||i}):l.word&&o.push(l),o.length&&u(t,o)},u=function(t,e){var r,n,o,d,a,i,l=[],s=0,u=t.nodeValue;for(a=0,i=e.length;a<i;a++)r=e[a],l.push({type:"text",text:u.slice(s,r.i-r.word.length)}),l.push({type:"word",text:u.slice(r.i-r.word.length,r.i),word:r.key}),s=r.i;for(l.push({type:"text",text:u.slice(s)}),n=t.parentNode,o=t.nextSibling,n.removeChild(t),a=0,i=l.length;a<i;a++)null!==(d=f(l[a]))&&n.insertBefore(d,o)},f=function(t){var e,r;return t.text&&0!==t.text.length?(t.word?((e=document.createElement(l.defTag)).innerHTML=t.text,l.attrDef&&(r=n[t.word],l.includeWord&&(r=t.text+": "+r),e.setAttribute(l.attrDef,r)),l.attrKey&&e.setAttribute(l.attrKey,t.word),l.addClass&&(e.className=l.addClass)):e=document.createTextNode(t.text),e):null}}(jQuery);
